# Тестовое задание в команду продуктовой аналитики "Одноклассников"
#### Выполняет: Никита Лисоветин, студент группы М3339 кафедры КТ университета ИТМО ([telegram](t.me/nikitalisovetin), [github](github.com/turing228))

------------------------------

## SQL задачки

Решения написаны на PostgreSQL и находятся в файлах `sql1.sql`, `sql2.sql`, `sql3.sql`. Для запуска можно вставить код, например, [на этом сайте](sqliteonline.com/). Код сопровождается комментариями, где это логически может быть важно. Для тестирования я менял порядок строчек или некоторые значения в создаваемых таблицах.

------------------------------

## A/B тест задача

Все решение написано на Python и находится в файле `ab_test_task_1.ipynb`, там же и рекомендации к дальнейшей работе. В файле `Numbers_And_Graphics.xlsx` объединены основные результаты и графики из картинок, в картинке `result.png` его скриншот.

<p align="center">
    <img src="/result.png" width="800" title="Numbers And Graphics">
</p>

### Результат A/B теста

(повторяет результат из `ab_test_task_1.ipynb`)

В рамках тестового задания мы не знаем откуда мы получили данные, но для решения задачи это важно понимать. Сформулируем решаемую задачу и объясним смысл исследуемых данных следующим образом:

## Задача

В течение недели в онлайн-магазин заходили пользователи и совершали покупки. В половине сессий показывался один дизайн сайта, в другой половине - другой. Соответственно, одной записе в таблице соответствует одна сессия. Хочется извлечь максимум из данных, выдвинуть гипотезы и дать рекомендации по дальнейшей работе

## Результат

На изображении results.png перечислены основные метрики и графики.

Доходы в тестовой и контрольной выборках в заказах с revenue до 8.0 распределяются одинаково и не отличаются значимо. Но за счет заказов с revenue больше 8.0, которые составляют по количеству 17.76% от всех заказов и 70.44% по сумме дохода, контрольная выборка показала гораздо лучшие метрики (на нее пришлось 70.37% дорогих заказов по количеству и 70.86% по сумме дохода; разные люди несколько раз заходят на сайт и совершают дорогую покупку именно на контрольном дизайне).

В тестовой группе выявлены значимое падение по многим метрикам: общий доход, средняя сумма заказа и средняя сумма заказа пользователя на 38-45%.

При этом общее число заказов и конверсия сессии в заказ не изменились значимо.

===

Парная выборка (то есть по пользователям, видевших оба дизайна), составленная из исходных сырых данных, не показала значимой разницы между метриками. Требуется больше данных для принятия статистически верного решения (сейчас высока вероятность ошибки второго рода).


# Что дальше?

(Disclaimer: в рамках тестовой задачи мы не знаем какая задача именно решалась и как ставился a/b тест, но мы можем предположить разные варианты и предложить дальнейшие действия)

Мы поняли, что почему-то **дорогие заказы совершают в контрольном дизайне. И они очень важны.** Теперь главные вопросы: 
* Почему?
* Как мы можем еще помочь пользователям?
* Как нам дальше развивать продукт и увеличивать прибыль?

Чтобы ответить на них нужно понять (под пунктами примеры ситуаций):

1. Что именно отличается в тестовом и контрольном дизайнах и как это может логически влиять на совершение/не совершение дорогого заказа + сравнить с конкурентами с похожими товарами
    * Дорогим пользователям важно пообщаться с оператором в чате (тот самый, который "Я тут, напишите мне, я Вам помогу"), который пропал из тестового дизайна
    * Некоторая ценность важна для совершения дорогой покупки (например, написано, что "гарантия - MUST HAVE", а это телефон за 60 тысяч рублей и она в придачу на 3 года; или доставка за 1 день), которая не демонстрируется или стала незаметна в тестовом дизайне
    * Просто в "рекомендациях" не всплывают дорогие товары и, соответственно, потенциальный покупатель не узнает о них или о том, что вообще такое можно купить на сайте
    * "Фейковая" скидка на товар или другой бонус (wildberries вот постоянно меняет цены и, возможно, в тестовом дизайне он бы решил сразу показать минимальную цену и получил бы такие данные)
    * Добротный логотип, внушающий доверие
    * Огромная кнопка "купить в 1 клик"
    * Заметные логотипы VISA, MasterCard, показывающие возможность быстро сделать покупку
    * 3D-модель товара
    * В тестовом дизайне появилась возможность сортировать по возрастанию цены (или даже по-дефолту, или "ограничить цену от и до"), все пользователи начали сразу сортировать и, соответственно, просто тупо перестали доходить до дорогих товаров
    * Что-то отвалилось на одной из платформ (десктоп, андроид, айос) и тупо не успевает загрузиться
    * Для дорогих товаров картинки настолько крутые, что в тестовом дизайне загружаться стали слишком долго
    * В тестовом дизайне важный элемент блокируется адблокером
1. Поведение пользователей, желающих совершить дорогой заказ, и как контрольный дизайн им помогает
    * Ищут ли они специально этот дорогой товар или случайно натыкаются и сразу покупают?
    * Как долго принимают решение? Находят утром и покупают вечером или ждут неделю?
    * Гложат ли их сомнения, смотрят ли аналоги, сколько времени проводят на сайте, звонят ли по горячей линии, что спрашивают в чате?
1. Что объединяет этих пользователей?
    * Это "родители младенцев"?
    * Они добавляют очень много товаров в "понравившиеся"/"сравнение"
    * Они заходят на наш сайт лишь чтобы проверить цену на дорогие товары?
    * Они покупают только дорогие товары? (соответственно, тогда, возможно, все дешевые просто можно убрать и заточить продукт под дорогие)
1. Что объединяет эти товары? (возможно, что они одного типа или похожих)
    * Товары для профессиональных спортсменов
    * Товары для дачников
    * Это реально классные качественные товары
    * Это аксессуары для техники Apple
1. Что отличает эти товары от остальных на сайте?
    * У них большое красивое описание
    * Товары от классных брендов
    * В тестовом дизайне нужно нажать отдельную кнопку, чтобы увидеть дорогие товары
    
## Несколько задач для аналитиков данных

1. Посмотреть на просмотры дорогих товаров. Менятся ли конверсия на дорогих товарах в зависимости от дизайна?
1. Посмотреть на общее поведение пользователей, совершивших дорогой заказ или которые могли его совершить: искали ли они именно его, были ли их сессии подряд (возможно, что на сайте баг и они специально обновляли страницу) или с перерывом (какой это перерыв? утро-вечер, 2 дня, неделя?) (сколько времени проходит от просмотра до покупки?), на какой платформе, куда тыкали на сайте
1. Изучить пользователей, совершивших дорогой заказ. Составить их портрет. Отличается ли он от других пользователей?
1. Продлить или расширить текущий a/b тест для статистически значимого анализа парной выборки: меняется ли доход от конкретного пользователя, когда он видит контрольный или тестовый дизайн?
1. Изучить дорогие товары, которые купили эти пользователи: что их объединяет, что отличает?

# Вердикт

Хоть тестовое решение и показало значительное снижение дохода, a/b тест был важным: он показал, что какая-то конкретная вещь влияет на 20% пользователей, совершающих дорогие покупки с revenue > 8.0 и делающих 70% суммарного дохода. При этом никак не влияет на 80% пользователей, совершающих покупки с revenue <= 8.0.

В зависимости от того, что именно было сделано, возможно, что целесообразно раскатить фичу на товары с revenue <= 8.0 (если это экономит что-либо: железо (если меньше данных хранить и считать нужно или скорость выдачи понижаем), работу операторов чатов, работу фотографов, редакторов), а для товаров с revenue > 8.0 усилить сильные стороны текущего решения (возможно, что даже просто начать продавать только эти товары или демонстрируя на главной только их). Дополнительная аналитика поможет лучше понять, кто эти пользователи и какие ценности им важны, какие новые идеи (а не изменение текущих решений) могут помочь людям, совершающим дорогие заказы и, соответственно, увеличить наш доход.

Ну, и, вне зависимости от деталей задачи, если экономия от введения фичи больше падения дохода, то, конечно, тоже целесообразно ее продолжать раскатывать постепенно (если a/b тест был на 1%, то нужно дальше на 10%, 50%, 100% и на всех потом раскатить, если результаты будут подтверждаться).

Если речь идет о кратковременной акции (день холостяка) или сезонном предложении (маски от коронавируса), то нужно переосмыслить решение перед следующим разом, потому что идея может быть хорошей, но мы только потеряли важных для нас пользователей.
